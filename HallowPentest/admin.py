from django.contrib import admin

from .models import (
    Action,
    Attacker,
    Credential,
    Parameter,
    Phase,
    Port,
    Service,
    Target,
    TargetService,
    Task,
    Tool,
    Vulnerability
)


@admin.register(Port)
class PortAdmin(admin.ModelAdmin):
    prepopulated_fields = {'slug': ('number', 'protocol')}


class TargetServiceInline(admin.TabularInline):
    model = TargetService
    extra = 1


@admin.register(Target)
class TargetAdmin(admin.ModelAdmin):
    inlines = (TargetServiceInline,)


admin.site.register(Attacker)
admin.site.register(Service)
admin.site.register(TargetService)
admin.site.register(Credential)
admin.site.register(Parameter)
admin.site.register(Phase)
admin.site.register(Vulnerability)
admin.site.register(Tool)
admin.site.register(Action)
admin.site.register(Task)
